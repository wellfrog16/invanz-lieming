var isSupportTouch = document["ontouchstart"] === null;
StartEvent = isSupportTouch ? "touchstart" : "mousedown";
MoveEvent = isSupportTouch ? "touchmove" : "mousemove";
EndEvent = isSupportTouch ? "touchend" : "mouseup";

//打开PDF
function openPdfFile(event,path,isshare)
{
	var pdf = null;
	if(event)
	{
		var domview = event["getAttribute"]?event:event.target;
		if(domview)
		{
			pdf = domview.getAttribute("data-file");
			if(domview.getAttribute("data-kpi-desc") && domview.getAttribute("data-kpi-id"))
			{
				addKpi(domview.getAttribute("data-kpi-desc"),domview.getAttribute("data-kpi-id"));
			}
		}
	}else{
		console.log("no addAsset");
	}
	if (window.parent.PDFHelper && window.parent.PDFHelper.OpenPDF)
		window.parent.PDFHelper.OpenPDF(path?path:pdf, window, isshare==undefined?true:isshare);
	else
		window.open(path?path:pdf);
}
//兼容浏览及移动设备跳转Sequence
//sqname  SequenceName
//isanimation 是否需要动画，默认true
function navigate_To_Sequence(sqname,isanimation)
{
	var animation= isanimation==undefined || isanimation?"animation":"noanimation";
	console.log(window.parent.navigateToSequence);
	if(window.parent.navigateToSequence)window.parent.navigateToSequence(sqname,animation);
	else document.location = '../'+sqname+"/index.html";
}
//跳转Sequence  建议使用此代理方法
//<a onClick="goToSequence(this,false)" data-url="path"></a>
function goToSequence(event,isanimation)
{
	if(!event)return;
	var url = null;
	if(event)
	{
		url  =event["getAttribute"]?event.getAttribute("data-url"):event.target.getAttribute("data-url");
	}
	console.log(url);
	navigate_To_Sequence(url,isanimation);
}

//顺序翻页下一页
function goNextSequence()
{
	if(window.parent)window.parent.goNextSequence();
	else document.location = "./";
}
//順序分頁上一頁
function goPreviousSequence()
{
	if(window.parent.goPreviousSequence)window.parent.goPreviousSequence();
	else document.location = "./";
}

//發送郵件服務
function sendEmail()
{
	if(window.parent.sendEmail)window.parent.sendEmail();
	else console.log("not supported sendEmail");
}

//
//This will update the event_presentation_asset table in the MIDatabase.
//description  描述
//external_id  KPIID
kpi_time_in = Date.now();
function addKpi(description,external_id){
	var kpi_time_out = Date.now();
	var duration = parseInt((kpi_time_out - kpi_time_in) / 1000);
	if(window.parent.addAsset)window.parent.addAsset(description,kpi_time_in,duration,external_id);
	else console.log(description+","+kpi_time_in+","+duration+","+external_id);
	kpi_time_in = Date.now();
}